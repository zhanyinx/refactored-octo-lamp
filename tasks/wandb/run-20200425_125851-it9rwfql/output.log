WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 288 steps, validate for 64 steps
Epoch 1/1000
2020-04-25 14:58:55.152799: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: Incompatible shapes: [1,128,128,3] vs. [1,64,64,3]
	 [[{{node loss/activation_8_loss/logistic_loss/mul}}]]
  1/288 [..............................] - ETA: 5:18Traceback (most recent call last):
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 767, in on_epoch
    yield epoch_logs
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 342, in fit
    total_epochs=epochs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 128, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py", line 98, in execution_function
    distributed_function(input_fn))
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py", line 568, in __call__
    result = self._call(*args, **kwds)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py", line 632, in _call
    return self._stateless_fn(*args, **kwds)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 2363, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 1611, in _filtered_call
    self.captured_inputs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 1692, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 545, in call
    ctx=ctx)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/execute.py", line 67, in quick_execute
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError:  Incompatible shapes: [1,128,128,3] vs. [1,64,64,3]
	 [[node loss/activation_8_loss/logistic_loss/mul (defined at ../spot_detection/losses/binary_crossentropy.py:4) ]] [Op:__inference_distributed_function_1792]

Errors may have originated from an input operation.
Input Source operations connected to node loss/activation_8_loss/logistic_loss/mul:
 model/conv2d_8/BiasAdd (defined at /Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/wandb/keras/__init__.py:112)

Function call stack:
distributed_function


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/callbacks.py", line 1040, in _save_model
    self.model.save(filepath, overwrite=True)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/network.py", line 1008, in save
    signatures, options)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/saving/save.py", line 112, in save_model
    model, filepath, overwrite, include_optimizer)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/saving/hdf5_format.py", line 92, in save_model_to_hdf5
    f = h5py.File(filepath, mode='w')
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/h5py/_hl/files.py", line 394, in __init__
    swmr=swmr)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/h5py/_hl/files.py", line 176, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 105, in h5py.h5f.create
OSError: Unable to create file (unable to open file: name = '../models/model_1587819533.h5', errno = 2, error message = 'No such file or directory', flags = 13, o_flags = 602)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "../training/run_experiment.py", line 38, in <module>
    main()
  File "../training/run_experiment.py", line 34, in main
    run_experiment(cfg)
  File "../training/util_training.py", line 125, in run_experiment
    model = train_model(model, dataset)
  File "../training/util_training.py", line 66, in train_model
    _history = model.fit(dataset=dataset, callbacks=callbacks)
  File "../spot_detection/models/base.py", line 94, in fit
    shuffle=True,
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py", line 819, in fit
    use_multiprocessing=use_multiprocessing)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/wandb/keras/__init__.py", line 112, in new_v2
    return old_v2(*args, **kwargs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 397, in fit
    prefix='val_')
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 771, in on_epoch
    self.callbacks.on_epoch_end(epoch, epoch_logs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/callbacks.py", line 302, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/callbacks.py", line 992, in on_epoch_end
    self._save_model(epoch=epoch, logs=logs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/callbacks.py", line 1045, in _save_model
    if 'is a directory' in e.message:
AttributeError: 'OSError' object has no attribute 'message'
