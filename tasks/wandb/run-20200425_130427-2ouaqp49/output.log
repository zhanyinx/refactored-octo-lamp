WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 288 steps, validate for 64 steps
Epoch 1/1000
2020-04-25 15:04:30.782655: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: Incompatible shapes: [1,128,128,3] vs. [1,64,64,3]
	 [[{{node loss/activation_8_loss/logistic_loss/mul}}]]
  1/288 [..............................] - ETA: 4:47  1/288 [..............................] - ETA: 5:08Traceback (most recent call last):
  File "../training/run_experiment.py", line 38, in <module>
    main()
  File "../training/run_experiment.py", line 34, in main
    run_experiment(cfg)
  File "../training/util_training.py", line 125, in run_experiment
    model = train_model(model, dataset)
  File "../training/util_training.py", line 66, in train_model
    _history = model.fit(dataset=dataset, callbacks=callbacks)
  File "../spot_detection/models/base.py", line 91, in fit
    validation_data=valid_sequence,
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py", line 819, in fit
    use_multiprocessing=use_multiprocessing)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/wandb/keras/__init__.py", line 112, in new_v2
    return old_v2(*args, **kwargs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 342, in fit
    total_epochs=epochs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 128, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py", line 98, in execution_function
    distributed_function(input_fn))
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py", line 568, in __call__
    result = self._call(*args, **kwds)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py", line 632, in _call
    return self._stateless_fn(*args, **kwds)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 2363, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 1611, in _filtered_call
    self.captured_inputs)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 1692, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py", line 545, in call
    ctx=ctx)
  File "/Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow_core/python/eager/execute.py", line 67, in quick_execute
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError:  Incompatible shapes: [1,128,128,3] vs. [1,64,64,3]
	 [[node loss/activation_8_loss/logistic_loss/mul (defined at ../spot_detection/losses/binary_crossentropy.py:4) ]] [Op:__inference_distributed_function_1792]

Errors may have originated from an input operation.
Input Source operations connected to node loss/activation_8_loss/logistic_loss/mul:
 model/conv2d_8/BiasAdd (defined at /Users/yinxiu/anaconda3/envs/tf/lib/python3.6/site-packages/wandb/keras/__init__.py:112)

Function call stack:
distributed_function

